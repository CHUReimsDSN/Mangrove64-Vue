(function(_e,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("vue"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","vue","quasar"],l):(_e=typeof globalThis<"u"?globalThis:_e||self,l(_e["mangrove64-vue"]={},_e.Vue,_e.Quasar))})(this,function(_e,l,ut){"use strict";const In=l.defineComponent({__name:"TreeTableHeaderCell",props:{column:{},index:{},resizableColumns:{type:Boolean},borderStrategy:{},theme:{}},setup(o){const t=o,n=l.ref(null),e=l.ref(null);let r=0,i=0,a=!1;function s(b){b.button===0&&(d(b.clientX),b.preventDefault())}function c(b){const N=b.touches[0];N&&(d(N.clientX),b.preventDefault())}function d(b){const N=n.value;N&&(r=b,i=N.getBoundingClientRect().width,a=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none",document.addEventListener("mousemove",h),document.addEventListener("mouseup",y),document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("touchend",w))}function h(b){a&&v(b.clientX)}function f(b){if(!a)return;const N=b.touches[0];N&&(v(N.clientX),b.preventDefault())}function v(b){const N=n.value;if(!N)return;const le=b-r,j=Math.max(60,Math.round(i+le));N.style.width=`${j}px`}function y(){D()}function w(){D()}function D(){a&&(a=!1,document.body.style.cursor="",document.body.style.userSelect="",document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",f),document.removeEventListener("touchend",w))}const L=l.computed(()=>`text-align: ${t.column.align??"left"};`),W=l.computed(()=>{let b="mangrove64-cell-header-content";return t.theme==="dark"&&(b+=" mangrove64-cell-header-content-dark"),b}),x=l.computed(()=>{let b="mangrove64-cell-header";return t.borderStrategy!=="none"&&(b+=" mangrove64-bordered-ltrb"),b});return l.onMounted(()=>{if(!t.resizableColumns)return;const b=e.value;b&&(b.addEventListener("mousedown",s),b.addEventListener("touchstart",c,{passive:!1}))}),l.onBeforeUnmount(()=>{if(!t.resizableColumns)return;const b=e.value;b&&(b.removeEventListener("mousedown",s),b.removeEventListener("touchstart",c)),D()}),(b,N)=>(l.openBlock(),l.createElementBlock("th",{class:l.normalizeClass(x.value),ref_key:"thEl",ref:n},[l.createElementVNode("div",{class:l.normalizeClass(W.value),style:l.normalizeStyle(L.value)},[l.createTextVNode(l.toDisplayString(t.column.label)+" ",1),t.resizableColumns?(l.openBlock(),l.createElementBlock("div",{key:0,class:"mangrove64-resize-handle",ref_key:"handle",ref:e},null,512)):l.createCommentVNode("",!0)],6)],2))}}),Bn={key:1,class:"mangrove64-cell-inner"},Pn=l.defineComponent({__name:"TreeTableBodyCell",props:{node:{},column:{},cellCssClass:{},borderStrategy:{},slotRender:{}},setup(o){const t=o,n=l.computed(()=>{if(t.column.format)return t.column.format(t.node);if(t.column.fieldTarget)return t.node[t.column.fieldTarget]}),e=l.computed(()=>{let r="mangrove64-cell";switch(r+=` ${t.cellCssClass}`,t.column.cssClass&&(r+=` ${t.column.cssClass}`),t.borderStrategy){case"horizontal":r+=" mangrove64-bordered-t";break;case"vertical":r+=" mangrove64-bordered-lr";break;case"cell":r+=" mangrove64-bordered-ltr";break}return r});return(r,i)=>(l.openBlock(),l.createElementBlock("td",{class:l.normalizeClass(e.value)},[t.slotRender?(l.openBlock(),l.createBlock(l.resolveDynamicComponent({render:()=>t.slotRender({node:t.node})}),{key:0})):(l.openBlock(),l.createElementBlock("div",Bn,l.toDisplayString(n.value),1))],2))}}),Kn={class:"flex row no-wrap items-center mangrove64-cell-inner"},Rn={key:1,class:"q-pr-xs"},Fn={key:4},Ln=l.defineComponent({__name:"TreeTableBodyFirstRowCell",props:{node:{},column:{},level:{},indentationPx:{},leaf:{type:Boolean},expanded:{type:Boolean},selected:{type:Boolean},isLoading:{type:Boolean},disabled:{type:Boolean},selectionMode:{},cellCssClass:{},borderStrategy:{},slotRender:{},checkboxColor:{}},emits:["node-expand-toggle","node-checkbox-toggle"],setup(o,{emit:t}){const n=t,e=o,r=l.ref(e.selected);function i(){e.disabled||n("node-expand-toggle",e.node,!e.expanded)}function a(){e.disabled||n("node-checkbox-toggle",e.node,!e.selected)}const s=l.computed(()=>e.selectionMode==="checkbox"),c=l.computed(()=>{if(e.column.format)return e.column.format(e.node);if(e.column.fieldTarget)return e.node[e.column.fieldTarget]}),d=l.computed(()=>{let f="mangrove64-cell";switch(f+=` ${e.cellCssClass}`,e.column.cssClass&&(f+=` ${e.column.cssClass}`),e.selected&&(f+=" mangrove64-selected"),e.borderStrategy){case"horizontal":f+=" mangrove64-bordered-t";break;case"vertical":f+=" mangrove64-bordered-lr";break;case"cell":f+=" mangrove64-bordered-ltr";break}return f}),h=l.computed(()=>`padding-left: ${e.level*e.indentationPx}px;`);return l.watch(()=>e.selected,f=>{r.value=f}),(f,v)=>(l.openBlock(),l.createElementBlock("td",{class:l.normalizeClass(d.value),style:l.normalizeStyle(h.value)},[l.createElementVNode("div",Kn,[s.value?(l.openBlock(),l.createBlock(l.unref(ut.QCheckbox),{key:0,"onUpdate:modelValue":[a,v[0]||(v[0]=y=>r.value=y)],modelValue:r.value,size:"xs",dense:"",color:e.checkboxColor,disabled:e.disabled},null,8,["modelValue","color","disabled"])):l.createCommentVNode("",!0),e.isLoading?(l.openBlock(),l.createBlock(l.unref(ut.QSpinner),{key:2,size:"xs",color:e.checkboxColor,thickness:4},null,8,["color"])):(l.openBlock(),l.createElementBlock(l.Fragment,{key:1},[e.leaf?(l.openBlock(),l.createElementBlock("span",Rn)):(l.openBlock(),l.createElementBlock(l.Fragment,{key:0},[e.expanded?(l.openBlock(),l.createBlock(l.unref(ut.QIcon),{key:1,onClick:i,name:"keyboard_arrow_down",size:"1.2rem",class:"cursor-pointer"})):(l.openBlock(),l.createBlock(l.unref(ut.QIcon),{key:0,onClick:i,name:"chevron_right",size:"1.2rem",class:"cursor-pointer"}))],64))],64)),e.slotRender?(l.openBlock(),l.createBlock(l.resolveDynamicComponent({render:()=>e.slotRender({node:e.node})}),{key:3})):(l.openBlock(),l.createElementBlock("div",Fn,l.toDisplayString(c.value),1))])],6))}}),zn=["data-key"],Hn=l.defineComponent({__name:"TreeTableRow",props:{node:{},columns:{},nodeKey:{},childrenKey:{},hasChildrenKey:{},disabledKey:{},selectionMode:{},expanded:{type:Boolean},selected:{type:Boolean},isLoading:{type:Boolean},hidden:{type:Boolean},level:{},indentationPx:{},borderStrategy:{},rowCssClass:{},cellCssClass:{},slotMap:{},checkboxColor:{}},emits:["node-expand-toggle","node-checkbox-toggle","node-click"],setup(o,{emit:t}){const n=t,e=o;function r(f,v){n("node-expand-toggle",f,v)}function i(f,v){n("node-checkbox-toggle",f,v)}function a(f){n("node-click",f)}function s(f){return f[e.nodeKey]}const c=l.computed(()=>!e.node[e.hasChildrenKey]),d=l.computed(()=>{if(e.disabledKey!==void 0)return e.node[e.disabledKey]}),h=l.computed(()=>{let f="mangrove64-row";return f+=` ${e.rowCssClass}`,e.selected&&(f+=" mangrove64-row-selected"),e.hidden&&(f+=" mangrove64-row-hidden"),f});return(f,v)=>(l.openBlock(),l.createElementBlock("tr",{onClick:v[0]||(v[0]=y=>a(e.node)),class:l.normalizeClass(h.value),"data-key":s(e.node)},[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.columns,(y,w)=>(l.openBlock(),l.createElementBlock(l.Fragment,{key:y.name},[w===0?(l.openBlock(),l.createBlock(Ln,{key:0,column:y,node:e.node,level:e.level,indentationPx:e.indentationPx,leaf:c.value,expanded:e.expanded,disabled:d.value,selected:e.selected,isLoading:e.isLoading,selectionMode:e.selectionMode,"cell-css-class":e.cellCssClass,"border-strategy":e.borderStrategy,"slot-render":e.slotMap.get(y.name),"checkbox-color":e.checkboxColor,onNodeExpandToggle:r,onNodeCheckboxToggle:i},null,8,["column","node","level","indentationPx","leaf","expanded","disabled","selected","isLoading","selectionMode","cell-css-class","border-strategy","slot-render","checkbox-color"])):(l.openBlock(),l.createBlock(Pn,{key:1,column:y,node:e.node,"cell-css-class":e.cellCssClass,"border-strategy":e.borderStrategy,"slot-render":e.slotMap.get(y.name)},null,8,["column","node","cell-css-class","border-strategy","slot-render"]))],64))),128))],10,zn))}}),Xn=["data-key"],$n="__mangrove64-fake-row-",Yn=l.defineComponent({__name:"TreeTableFakeRow",props:{node:{},columns:{},nodeKey:{},disabledKey:{},expanded:{type:Boolean},selected:{type:Boolean},hidden:{type:Boolean},level:{},indentationPx:{},borderStrategy:{},rowCssClass:{},cellCssClass:{},isDragging:{type:Boolean}},emits:["node-click"],setup(o,{emit:t}){const n=t,e=o;function r(d){return d[e.nodeKey]}function i(d){return`${$n}${r(d).toString()}`}function a(d){n("node-click",d)}const s=l.computed(()=>{let d="mangrove64-row mangrove64-fake-row";return d+=` ${e.rowCssClass}`,e.selected&&(d+=" mangrove64-row-selected"),e.hidden&&(d+=" mangrove64-row-hidden"),e.isDragging&&(d+=" mangrove64-fake-row-display"),d}),c=l.computed(()=>{let d="";switch(d+=` ${e.cellCssClass}`,e.borderStrategy){case"horizontal":d+=" mangrove64-bordered-b";break;case"vertical":d+=" mangrove64-bordered-lr";break;case"cell":d+=" mangrove64-bordered-lbr";break}return d});return(d,h)=>(l.openBlock(),l.createElementBlock("tr",{onClick:h[0]||(h[0]=f=>a(e.node)),class:l.normalizeClass(s.value),"data-key":i(e.node)},[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(e.columns,f=>(l.openBlock(),l.createElementBlock("td",{key:f.name,class:l.normalizeClass(c.value)},null,2))),128))],10,Xn))}});/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function en(o,t){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable})),n.push.apply(n,e)}return n}function ge(o){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?en(Object(n),!0).forEach(function(e){Gn(o,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(n,e))})}return o}function ft(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ft=function(t){return typeof t}:ft=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(o)}function Gn(o,t,n){return t in o?Object.defineProperty(o,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[t]=n,o}function ue(){return ue=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(o[e]=n[e])}return o},ue.apply(this,arguments)}function Vn(o,t){if(o==null)return{};var n={},e=Object.keys(o),r,i;for(i=0;i<e.length;i++)r=e[i],!(t.indexOf(r)>=0)&&(n[r]=o[r]);return n}function Wn(o,t){if(o==null)return{};var n=Vn(o,t),e,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);for(r=0;r<i.length;r++)e=i[r],!(t.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(o,e)&&(n[e]=o[e])}return n}function jn(o){return Un(o)||qn(o)||Qn(o)||Zn()}function Un(o){if(Array.isArray(o))return At(o)}function qn(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}function Qn(o,t){if(o){if(typeof o=="string")return At(o,t);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor&&(n=o.constructor.name),n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(o,t)}}function At(o,t){(t==null||t>o.length)&&(t=o.length);for(var n=0,e=new Array(t);n<t;n++)e[n]=o[n];return e}function Zn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Jn="1.15.6";function ye(o){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(o)}var Ee=ye(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),We=ye(/Edge/i),tn=ye(/firefox/i),je=ye(/safari/i)&&!ye(/chrome/i)&&!ye(/android/i),Nt=ye(/iP(ad|od|hone)/i),nn=ye(/chrome/i)&&ye(/android/i),on={capture:!1,passive:!1};function A(o,t,n){o.addEventListener(t,n,!Ee&&on)}function k(o,t,n){o.removeEventListener(t,n,!Ee&&on)}function ht(o,t){if(t){if(t[0]===">"&&(t=t.substring(1)),o)try{if(o.matches)return o.matches(t);if(o.msMatchesSelector)return o.msMatchesSelector(t);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(t)}catch{return!1}return!1}}function rn(o){return o.host&&o!==document&&o.host.nodeType?o.host:o.parentNode}function re(o,t,n,e){if(o){n=n||document;do{if(t!=null&&(t[0]===">"?o.parentNode===n&&ht(o,t):ht(o,t))||e&&o===n)return o;if(o===n)break}while(o=rn(o))}return null}var an=/\s+/g;function X(o,t,n){if(o&&t)if(o.classList)o.classList[n?"add":"remove"](t);else{var e=(" "+o.className+" ").replace(an," ").replace(" "+t+" "," ");o.className=(e+(n?" "+t:"")).replace(an," ")}}function E(o,t,n){var e=o&&o.style;if(e){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(o,""):o.currentStyle&&(n=o.currentStyle),t===void 0?n:n[t];!(t in e)&&t.indexOf("webkit")===-1&&(t="-webkit-"+t),e[t]=n+(typeof n=="string"?"":"px")}}function Ne(o,t){var n="";if(typeof o=="string")n=o;else do{var e=E(o,"transform");e&&e!=="none"&&(n=e+" "+n)}while(!t&&(o=o.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function ln(o,t,n){if(o){var e=o.getElementsByTagName(t),r=0,i=e.length;if(n)for(;r<i;r++)n(e[r],r);return e}return[]}function me(){var o=document.scrollingElement;return o||document.documentElement}function B(o,t,n,e,r){if(!(!o.getBoundingClientRect&&o!==window)){var i,a,s,c,d,h,f;if(o!==window&&o.parentNode&&o!==me()?(i=o.getBoundingClientRect(),a=i.top,s=i.left,c=i.bottom,d=i.right,h=i.height,f=i.width):(a=0,s=0,c=window.innerHeight,d=window.innerWidth,h=window.innerHeight,f=window.innerWidth),(t||n)&&o!==window&&(r=r||o.parentNode,!Ee))do if(r&&r.getBoundingClientRect&&(E(r,"transform")!=="none"||n&&E(r,"position")!=="static")){var v=r.getBoundingClientRect();a-=v.top+parseInt(E(r,"border-top-width")),s-=v.left+parseInt(E(r,"border-left-width")),c=a+i.height,d=s+i.width;break}while(r=r.parentNode);if(e&&o!==window){var y=Ne(r||o),w=y&&y.a,D=y&&y.d;y&&(a/=D,s/=w,f/=w,h/=D,c=a+h,d=s+f)}return{top:a,left:s,bottom:c,right:d,width:f,height:h}}}function sn(o,t,n){for(var e=De(o,!0),r=B(o)[t];e;){var i=B(e)[n],a=void 0;if(a=r>=i,!a)return e;if(e===me())break;e=De(e,!1)}return!1}function Fe(o,t,n,e){for(var r=0,i=0,a=o.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==C.ghost&&(e||a[i]!==C.dragged)&&re(a[i],n.draggable,o,!1)){if(r===t)return a[i];r++}i++}return null}function Mt(o,t){for(var n=o.lastElementChild;n&&(n===C.ghost||E(n,"display")==="none"||t&&!ht(n,t));)n=n.previousElementSibling;return n||null}function $(o,t){var n=0;if(!o||!o.parentNode)return-1;for(;o=o.previousElementSibling;)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==C.clone&&(!t||ht(o,t))&&n++;return n}function cn(o){var t=0,n=0,e=me();if(o)do{var r=Ne(o),i=r.a,a=r.d;t+=o.scrollLeft*i,n+=o.scrollTop*a}while(o!==e&&(o=o.parentNode));return[t,n]}function eo(o,t){for(var n in o)if(o.hasOwnProperty(n)){for(var e in t)if(t.hasOwnProperty(e)&&t[e]===o[n][e])return Number(n)}return-1}function De(o,t){if(!o||!o.getBoundingClientRect)return me();var n=o,e=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=E(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return me();if(e||t)return n;e=!0}}while(n=n.parentNode);return me()}function to(o,t){if(o&&t)for(var n in t)t.hasOwnProperty(n)&&(o[n]=t[n]);return o}function Ot(o,t){return Math.round(o.top)===Math.round(t.top)&&Math.round(o.left)===Math.round(t.left)&&Math.round(o.height)===Math.round(t.height)&&Math.round(o.width)===Math.round(t.width)}var Ue;function dn(o,t){return function(){if(!Ue){var n=arguments,e=this;n.length===1?o.call(e,n[0]):o.apply(e,n),Ue=setTimeout(function(){Ue=void 0},t)}}}function no(){clearTimeout(Ue),Ue=void 0}function un(o,t,n){o.scrollLeft+=t,o.scrollTop+=n}function It(o){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(o).cloneNode(!0):n?n(o).clone(!0)[0]:o.cloneNode(!0)}function fn(o,t){E(o,"position","absolute"),E(o,"top",t.top),E(o,"left",t.left),E(o,"width",t.width),E(o,"height",t.height)}function Bt(o){E(o,"position",""),E(o,"top",""),E(o,"left",""),E(o,"width",""),E(o,"height","")}function hn(o,t,n){var e={};return Array.from(o.children).forEach(function(r){var i,a,s,c;if(!(!re(r,t.draggable,o,!1)||r.animated||r===n)){var d=B(r);e.left=Math.min((i=e.left)!==null&&i!==void 0?i:1/0,d.left),e.top=Math.min((a=e.top)!==null&&a!==void 0?a:1/0,d.top),e.right=Math.max((s=e.right)!==null&&s!==void 0?s:-1/0,d.right),e.bottom=Math.max((c=e.bottom)!==null&&c!==void 0?c:-1/0,d.bottom)}}),e.width=e.right-e.left,e.height=e.bottom-e.top,e.x=e.left,e.y=e.top,e}var q="Sortable"+new Date().getTime();function oo(){var o=[],t;return{captureAnimationState:function(){if(o=[],!!this.options.animation){var e=[].slice.call(this.el.children);e.forEach(function(r){if(!(E(r,"display")==="none"||r===C.ghost)){o.push({target:r,rect:B(r)});var i=ge({},o[o.length-1].rect);if(r.thisAnimationDuration){var a=Ne(r,!0);a&&(i.top-=a.f,i.left-=a.e)}r.fromRect=i}})}},addAnimationState:function(e){o.push(e)},removeAnimationState:function(e){o.splice(eo(o,{target:e}),1)},animateAll:function(e){var r=this;if(!this.options.animation){clearTimeout(t),typeof e=="function"&&e();return}var i=!1,a=0;o.forEach(function(s){var c=0,d=s.target,h=d.fromRect,f=B(d),v=d.prevFromRect,y=d.prevToRect,w=s.rect,D=Ne(d,!0);D&&(f.top-=D.f,f.left-=D.e),d.toRect=f,d.thisAnimationDuration&&Ot(v,f)&&!Ot(h,f)&&(w.top-f.top)/(w.left-f.left)===(h.top-f.top)/(h.left-f.left)&&(c=io(w,v,y,r.options)),Ot(f,h)||(d.prevFromRect=h,d.prevToRect=f,c||(c=r.options.animation),r.animate(d,w,f,c)),c&&(i=!0,a=Math.max(a,c),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},c),d.thisAnimationDuration=c)}),clearTimeout(t),i?t=setTimeout(function(){typeof e=="function"&&e()},a):typeof e=="function"&&e(),o=[]},animate:function(e,r,i,a){if(a){E(e,"transition",""),E(e,"transform","");var s=Ne(this.el),c=s&&s.a,d=s&&s.d,h=(r.left-i.left)/(c||1),f=(r.top-i.top)/(d||1);e.animatingX=!!h,e.animatingY=!!f,E(e,"transform","translate3d("+h+"px,"+f+"px,0)"),this.forRepaintDummy=ro(e),E(e,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),E(e,"transform","translate3d(0,0,0)"),typeof e.animated=="number"&&clearTimeout(e.animated),e.animated=setTimeout(function(){E(e,"transition",""),E(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},a)}}}}function ro(o){return o.offsetWidth}function io(o,t,n,e){return Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*e.animation}var Le=[],Pt={initializeByDefault:!0},qe={mount:function(t){for(var n in Pt)Pt.hasOwnProperty(n)&&!(n in t)&&(t[n]=Pt[n]);Le.forEach(function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),Le.push(t)},pluginEvent:function(t,n,e){var r=this;this.eventCanceled=!1,e.cancel=function(){r.eventCanceled=!0};var i=t+"Global";Le.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][i]&&n[a.pluginName][i](ge({sortable:n},e)),n.options[a.pluginName]&&n[a.pluginName][t]&&n[a.pluginName][t](ge({sortable:n},e)))})},initializePlugins:function(t,n,e,r){Le.forEach(function(s){var c=s.pluginName;if(!(!t.options[c]&&!s.initializeByDefault)){var d=new s(t,n,t.options);d.sortable=t,d.options=t.options,t[c]=d,ue(e,d.defaults)}});for(var i in t.options)if(t.options.hasOwnProperty(i)){var a=this.modifyOption(t,i,t.options[i]);typeof a<"u"&&(t.options[i]=a)}},getEventProperties:function(t,n){var e={};return Le.forEach(function(r){typeof r.eventProperties=="function"&&ue(e,r.eventProperties.call(n[r.pluginName],t))}),e},modifyOption:function(t,n,e){var r;return Le.forEach(function(i){t[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[n]=="function"&&(r=i.optionListeners[n].call(t[i.pluginName],e))}),r}};function Qe(o){var t=o.sortable,n=o.rootEl,e=o.name,r=o.targetEl,i=o.cloneEl,a=o.toEl,s=o.fromEl,c=o.oldIndex,d=o.newIndex,h=o.oldDraggableIndex,f=o.newDraggableIndex,v=o.originalEvent,y=o.putSortable,w=o.extraEventProperties;if(t=t||n&&n[q],!!t){var D,L=t.options,W="on"+e.charAt(0).toUpperCase()+e.substr(1);window.CustomEvent&&!Ee&&!We?D=new CustomEvent(e,{bubbles:!0,cancelable:!0}):(D=document.createEvent("Event"),D.initEvent(e,!0,!0)),D.to=a||n,D.from=s||n,D.item=r||n,D.clone=i,D.oldIndex=c,D.newIndex=d,D.oldDraggableIndex=h,D.newDraggableIndex=f,D.originalEvent=v,D.pullMode=y?y.lastPutMode:void 0;var x=ge(ge({},w),qe.getEventProperties(e,t));for(var b in x)D[b]=x[b];n&&n.dispatchEvent(D),L[W]&&L[W].call(t,D)}}var ao=["evt"],ie=function(t,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.evt,i=Wn(e,ao);qe.pluginEvent.bind(C)(t,n,ge({dragEl:m,parentEl:R,ghostEl:S,rootEl:P,nextEl:Me,lastDownEl:pt,cloneEl:K,cloneHidden:ke,dragStarted:Je,putSortable:Q,activeSortable:C.active,originalEvent:r,oldIndex:ze,oldDraggableIndex:Ze,newIndex:ce,newDraggableIndex:xe,hideGhostForTarget:En,unhideGhostForTarget:wn,cloneNowHidden:function(){ke=!0},cloneNowShown:function(){ke=!1},dispatchSortableEvent:function(s){ne({sortable:n,name:s,originalEvent:r})}},i))};function ne(o){Qe(ge({putSortable:Q,cloneEl:K,targetEl:m,rootEl:P,oldIndex:ze,oldDraggableIndex:Ze,newIndex:ce,newDraggableIndex:xe},o))}var m,R,S,P,Me,pt,K,ke,ze,ce,Ze,xe,gt,Q,He=!1,mt=!1,vt=[],Oe,fe,Kt,Rt,pn,gn,Je,Xe,et,tt=!1,bt=!1,yt,J,Ft=[],Lt=!1,Et=[],wt=typeof document<"u",Ct=Nt,mn=We||Ee?"cssFloat":"float",lo=wt&&!nn&&!Nt&&"draggable"in document.createElement("div"),vn=function(){if(wt){if(Ee)return!1;var o=document.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}}(),bn=function(t,n){var e=E(t),r=parseInt(e.width)-parseInt(e.paddingLeft)-parseInt(e.paddingRight)-parseInt(e.borderLeftWidth)-parseInt(e.borderRightWidth),i=Fe(t,0,n),a=Fe(t,1,n),s=i&&E(i),c=a&&E(a),d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+B(i).width,h=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+B(a).width;if(e.display==="flex")return e.flexDirection==="column"||e.flexDirection==="column-reverse"?"vertical":"horizontal";if(e.display==="grid")return e.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return a&&(c.clear==="both"||c.clear===f)?"vertical":"horizontal"}return i&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||d>=r&&e[mn]==="none"||a&&e[mn]==="none"&&d+h>r)?"vertical":"horizontal"},so=function(t,n,e){var r=e?t.left:t.top,i=e?t.right:t.bottom,a=e?t.width:t.height,s=e?n.left:n.top,c=e?n.right:n.bottom,d=e?n.width:n.height;return r===s||i===c||r+a/2===s+d/2},co=function(t,n){var e;return vt.some(function(r){var i=r[q].options.emptyInsertThreshold;if(!(!i||Mt(r))){var a=B(r),s=t>=a.left-i&&t<=a.right+i,c=n>=a.top-i&&n<=a.bottom+i;if(s&&c)return e=r}}),e},yn=function(t){function n(i,a){return function(s,c,d,h){var f=s.options.group.name&&c.options.group.name&&s.options.group.name===c.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return n(i(s,c,d,h),a)(s,c,d,h);var v=(a?s:c).options.group.name;return i===!0||typeof i=="string"&&i===v||i.join&&i.indexOf(v)>-1}}var e={},r=t.group;(!r||ft(r)!="object")&&(r={name:r}),e.name=r.name,e.checkPull=n(r.pull,!0),e.checkPut=n(r.put),e.revertClone=r.revertClone,t.group=e},En=function(){!vn&&S&&E(S,"display","none")},wn=function(){!vn&&S&&E(S,"display","")};wt&&!nn&&document.addEventListener("click",function(o){if(mt)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),mt=!1,!1},!0);var Ie=function(t){if(m){t=t.touches?t.touches[0]:t;var n=co(t.clientX,t.clientY);if(n){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.target=e.rootEl=n,e.preventDefault=void 0,e.stopPropagation=void 0,n[q]._onDragOver(e)}}},uo=function(t){m&&m.parentNode[q]._isOutsideThisEl(t.target)};function C(o,t){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(o));this.el=o,this.options=t=ue({},t),o[q]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return bn(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:C.supportPointer!==!1&&"PointerEvent"in window&&(!je||Nt),emptyInsertThreshold:5};qe.initializePlugins(this,o,n);for(var e in n)!(e in t)&&(t[e]=n[e]);yn(t);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=t.forceFallback?!1:lo,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?A(o,"pointerdown",this._onTapStart):(A(o,"mousedown",this._onTapStart),A(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(A(o,"dragover",this),A(o,"dragenter",this)),vt.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),ue(this,oo())}C.prototype={constructor:C,_isOutsideThisEl:function(t){!this.el.contains(t)&&t!==this.el&&(Xe=null)},_getDirection:function(t,n){return typeof this.options.direction=="function"?this.options.direction.call(this,t,n,m):this.options.direction},_onTapStart:function(t){if(t.cancelable){var n=this,e=this.el,r=this.options,i=r.preventOnFilter,a=t.type,s=t.touches&&t.touches[0]||t.pointerType&&t.pointerType==="touch"&&t,c=(s||t).target,d=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||c,h=r.filter;if(yo(e),!m&&!(/mousedown|pointerdown/.test(a)&&t.button!==0||r.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&je&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=re(c,r.draggable,e,!1),!(c&&c.animated)&&pt!==c)){if(ze=$(c),Ze=$(c,r.draggable),typeof h=="function"){if(h.call(this,t,c,this)){ne({sortable:n,rootEl:d,name:"filter",targetEl:c,toEl:e,fromEl:e}),ie("filter",n,{evt:t}),i&&t.preventDefault();return}}else if(h&&(h=h.split(",").some(function(f){if(f=re(d,f.trim(),e,!1),f)return ne({sortable:n,rootEl:f,name:"filter",targetEl:c,fromEl:e,toEl:e}),ie("filter",n,{evt:t}),!0}),h)){i&&t.preventDefault();return}r.handle&&!re(d,r.handle,e,!1)||this._prepareDragStart(t,s,c)}}},_prepareDragStart:function(t,n,e){var r=this,i=r.el,a=r.options,s=i.ownerDocument,c;if(e&&!m&&e.parentNode===i){var d=B(e);if(P=i,m=e,R=m.parentNode,Me=m.nextSibling,pt=e,gt=a.group,C.dragged=m,Oe={target:m,clientX:(n||t).clientX,clientY:(n||t).clientY},pn=Oe.clientX-d.left,gn=Oe.clientY-d.top,this._lastX=(n||t).clientX,this._lastY=(n||t).clientY,m.style["will-change"]="all",c=function(){if(ie("delayEnded",r,{evt:t}),C.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!tn&&r.nativeDraggable&&(m.draggable=!0),r._triggerDragStart(t,n),ne({sortable:r,name:"choose",originalEvent:t}),X(m,a.chosenClass,!0)},a.ignore.split(",").forEach(function(h){ln(m,h.trim(),zt)}),A(s,"dragover",Ie),A(s,"mousemove",Ie),A(s,"touchmove",Ie),a.supportPointer?(A(s,"pointerup",r._onDrop),!this.nativeDraggable&&A(s,"pointercancel",r._onDrop)):(A(s,"mouseup",r._onDrop),A(s,"touchend",r._onDrop),A(s,"touchcancel",r._onDrop)),tn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,m.draggable=!0),ie("delayStart",this,{evt:t}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(We||Ee))){if(C.eventCanceled){this._onDrop();return}a.supportPointer?(A(s,"pointerup",r._disableDelayedDrag),A(s,"pointercancel",r._disableDelayedDrag)):(A(s,"mouseup",r._disableDelayedDrag),A(s,"touchend",r._disableDelayedDrag),A(s,"touchcancel",r._disableDelayedDrag)),A(s,"mousemove",r._delayedDragTouchMoveHandler),A(s,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&A(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(c,a.delay)}else c()}},_delayedDragTouchMoveHandler:function(t){var n=t.touches?t.touches[0]:t;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){m&&zt(m),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;k(t,"mouseup",this._disableDelayedDrag),k(t,"touchend",this._disableDelayedDrag),k(t,"touchcancel",this._disableDelayedDrag),k(t,"pointerup",this._disableDelayedDrag),k(t,"pointercancel",this._disableDelayedDrag),k(t,"mousemove",this._delayedDragTouchMoveHandler),k(t,"touchmove",this._delayedDragTouchMoveHandler),k(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,n){n=n||t.pointerType=="touch"&&t,!this.nativeDraggable||n?this.options.supportPointer?A(document,"pointermove",this._onTouchMove):n?A(document,"touchmove",this._onTouchMove):A(document,"mousemove",this._onTouchMove):(A(m,"dragend",this),A(P,"dragstart",this._onDragStart));try{document.selection?_t(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(t,n){if(He=!1,P&&m){ie("dragStarted",this,{evt:n}),this.nativeDraggable&&A(document,"dragover",uo);var e=this.options;!t&&X(m,e.dragClass,!1),X(m,e.ghostClass,!0),C.active=this,t&&this._appendGhost(),ne({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(fe){this._lastX=fe.clientX,this._lastY=fe.clientY,En();for(var t=document.elementFromPoint(fe.clientX,fe.clientY),n=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(fe.clientX,fe.clientY),t!==n);)n=t;if(m.parentNode[q]._isOutsideThisEl(t),n)do{if(n[q]){var e=void 0;if(e=n[q]._onDragOver({clientX:fe.clientX,clientY:fe.clientY,target:t,rootEl:n}),e&&!this.options.dragoverBubble)break}t=n}while(n=rn(n));wn()}},_onTouchMove:function(t){if(Oe){var n=this.options,e=n.fallbackTolerance,r=n.fallbackOffset,i=t.touches?t.touches[0]:t,a=S&&Ne(S,!0),s=S&&a&&a.a,c=S&&a&&a.d,d=Ct&&J&&cn(J),h=(i.clientX-Oe.clientX+r.x)/(s||1)+(d?d[0]-Ft[0]:0)/(s||1),f=(i.clientY-Oe.clientY+r.y)/(c||1)+(d?d[1]-Ft[1]:0)/(c||1);if(!C.active&&!He){if(e&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<e)return;this._onDragStart(t,!0)}if(S){a?(a.e+=h-(Kt||0),a.f+=f-(Rt||0)):a={a:1,b:0,c:0,d:1,e:h,f};var v="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");E(S,"webkitTransform",v),E(S,"mozTransform",v),E(S,"msTransform",v),E(S,"transform",v),Kt=h,Rt=f,fe=i}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!S){var t=this.options.fallbackOnBody?document.body:P,n=B(m,!0,Ct,!0,t),e=this.options;if(Ct){for(J=t;E(J,"position")==="static"&&E(J,"transform")==="none"&&J!==document;)J=J.parentNode;J!==document.body&&J!==document.documentElement?(J===document&&(J=me()),n.top+=J.scrollTop,n.left+=J.scrollLeft):J=me(),Ft=cn(J)}S=m.cloneNode(!0),X(S,e.ghostClass,!1),X(S,e.fallbackClass,!0),X(S,e.dragClass,!0),E(S,"transition",""),E(S,"transform",""),E(S,"box-sizing","border-box"),E(S,"margin",0),E(S,"top",n.top),E(S,"left",n.left),E(S,"width",n.width),E(S,"height",n.height),E(S,"opacity","0.8"),E(S,"position",Ct?"absolute":"fixed"),E(S,"zIndex","100000"),E(S,"pointerEvents","none"),C.ghost=S,t.appendChild(S),E(S,"transform-origin",pn/parseInt(S.style.width)*100+"% "+gn/parseInt(S.style.height)*100+"%")}},_onDragStart:function(t,n){var e=this,r=t.dataTransfer,i=e.options;if(ie("dragStart",this,{evt:t}),C.eventCanceled){this._onDrop();return}ie("setupClone",this),C.eventCanceled||(K=It(m),K.removeAttribute("id"),K.draggable=!1,K.style["will-change"]="",this._hideClone(),X(K,this.options.chosenClass,!1),C.clone=K),e.cloneId=_t(function(){ie("clone",e),!C.eventCanceled&&(e.options.removeCloneOnHide||P.insertBefore(K,m),e._hideClone(),ne({sortable:e,name:"clone"}))}),!n&&X(m,i.dragClass,!0),n?(mt=!0,e._loopId=setInterval(e._emulateDragOver,50)):(k(document,"mouseup",e._onDrop),k(document,"touchend",e._onDrop),k(document,"touchcancel",e._onDrop),r&&(r.effectAllowed="move",i.setData&&i.setData.call(e,r,m)),A(document,"drop",e),E(m,"transform","translateZ(0)")),He=!0,e._dragStartId=_t(e._dragStarted.bind(e,n,t)),A(document,"selectstart",e),Je=!0,window.getSelection().removeAllRanges(),je&&E(document.body,"user-select","none")},_onDragOver:function(t){var n=this.el,e=t.target,r,i,a,s=this.options,c=s.group,d=C.active,h=gt===c,f=s.sort,v=Q||d,y,w=this,D=!1;if(Lt)return;function L(Ce,Ut){ie(Ce,w,ge({evt:t,isOwner:h,axis:y?"vertical":"horizontal",revert:a,dragRect:r,targetRect:i,canSort:f,fromSortable:v,target:e,completed:x,onMove:function(st,Re){return St(P,n,m,r,st,B(st),t,Re)},changed:b},Ut))}function W(){L("dragOverAnimationCapture"),w.captureAnimationState(),w!==v&&v.captureAnimationState()}function x(Ce){return L("dragOverCompleted",{insertion:Ce}),Ce&&(h?d._hideClone():d._showClone(w),w!==v&&(X(m,Q?Q.options.ghostClass:d.options.ghostClass,!1),X(m,s.ghostClass,!0)),Q!==w&&w!==C.active?Q=w:w===C.active&&Q&&(Q=null),v===w&&(w._ignoreWhileAnimating=e),w.animateAll(function(){L("dragOverAnimationComplete"),w._ignoreWhileAnimating=null}),w!==v&&(v.animateAll(),v._ignoreWhileAnimating=null)),(e===m&&!m.animated||e===n&&!e.animated)&&(Xe=null),!s.dragoverBubble&&!t.rootEl&&e!==document&&(m.parentNode[q]._isOutsideThisEl(t.target),!Ce&&Ie(t)),!s.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),D=!0}function b(){ce=$(m),xe=$(m,s.draggable),ne({sortable:w,name:"change",toEl:n,newIndex:ce,newDraggableIndex:xe,originalEvent:t})}if(t.preventDefault!==void 0&&t.cancelable&&t.preventDefault(),e=re(e,s.draggable,n,!0),L("dragOver"),C.eventCanceled)return D;if(m.contains(t.target)||e.animated&&e.animatingX&&e.animatingY||w._ignoreWhileAnimating===e)return x(!1);if(mt=!1,d&&!s.disabled&&(h?f||(a=R!==P):Q===this||(this.lastPutMode=gt.checkPull(this,d,m,t))&&c.checkPut(this,d,m,t))){if(y=this._getDirection(t,e)==="vertical",r=B(m),L("dragOverValid"),C.eventCanceled)return D;if(a)return R=P,W(),this._hideClone(),L("revert"),C.eventCanceled||(Me?P.insertBefore(m,Me):P.appendChild(m)),x(!0);var N=Mt(n,s.draggable);if(!N||go(t,y,this)&&!N.animated){if(N===m)return x(!1);if(N&&n===t.target&&(e=N),e&&(i=B(e)),St(P,n,m,r,e,i,t,!!e)!==!1)return W(),N&&N.nextSibling?n.insertBefore(m,N.nextSibling):n.appendChild(m),R=n,b(),x(!0)}else if(N&&po(t,y,this)){var le=Fe(n,0,s,!0);if(le===m)return x(!1);if(e=le,i=B(e),St(P,n,m,r,e,i,t,!1)!==!1)return W(),n.insertBefore(m,le),R=n,b(),x(!0)}else if(e.parentNode===n){i=B(e);var j=0,we,Pe=m.parentNode!==n,ee=!so(m.animated&&m.toRect||r,e.animated&&e.toRect||i,y),Ae=y?"top":"left",se=sn(e,"top","top")||sn(m,"top","top"),ve=se?se.scrollTop:void 0;Xe!==e&&(we=i[Ae],tt=!1,bt=!ee&&s.invertSwap||Pe),j=mo(t,e,i,y,ee?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,bt,Xe===e);var te;if(j!==0){var G=$(m);do G-=j,te=R.children[G];while(te&&(E(te,"display")==="none"||te===S))}if(j===0||te===e)return x(!1);Xe=e,et=j;var Ke=e.nextElementSibling,pe=!1;pe=j===1;var Ge=St(P,n,m,r,e,i,t,pe);if(Ge!==!1)return(Ge===1||Ge===-1)&&(pe=Ge===1),Lt=!0,setTimeout(ho,30),W(),pe&&!Ke?n.appendChild(m):e.parentNode.insertBefore(m,pe?Ke:e),se&&un(se,0,ve-se.scrollTop),R=m.parentNode,we!==void 0&&!bt&&(yt=Math.abs(we-B(e)[Ae])),b(),x(!0)}if(n.contains(m))return x(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){k(document,"mousemove",this._onTouchMove),k(document,"touchmove",this._onTouchMove),k(document,"pointermove",this._onTouchMove),k(document,"dragover",Ie),k(document,"mousemove",Ie),k(document,"touchmove",Ie)},_offUpEvents:function(){var t=this.el.ownerDocument;k(t,"mouseup",this._onDrop),k(t,"touchend",this._onDrop),k(t,"pointerup",this._onDrop),k(t,"pointercancel",this._onDrop),k(t,"touchcancel",this._onDrop),k(document,"selectstart",this)},_onDrop:function(t){var n=this.el,e=this.options;if(ce=$(m),xe=$(m,e.draggable),ie("drop",this,{evt:t}),R=m&&m.parentNode,ce=$(m),xe=$(m,e.draggable),C.eventCanceled){this._nulling();return}He=!1,bt=!1,tt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ht(this.cloneId),Ht(this._dragStartId),this.nativeDraggable&&(k(document,"drop",this),k(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),je&&E(document.body,"user-select",""),E(m,"transform",""),t&&(Je&&(t.cancelable&&t.preventDefault(),!e.dropBubble&&t.stopPropagation()),S&&S.parentNode&&S.parentNode.removeChild(S),(P===R||Q&&Q.lastPutMode!=="clone")&&K&&K.parentNode&&K.parentNode.removeChild(K),m&&(this.nativeDraggable&&k(m,"dragend",this),zt(m),m.style["will-change"]="",Je&&!He&&X(m,Q?Q.options.ghostClass:this.options.ghostClass,!1),X(m,this.options.chosenClass,!1),ne({sortable:this,name:"unchoose",toEl:R,newIndex:null,newDraggableIndex:null,originalEvent:t}),P!==R?(ce>=0&&(ne({rootEl:R,name:"add",toEl:R,fromEl:P,originalEvent:t}),ne({sortable:this,name:"remove",toEl:R,originalEvent:t}),ne({rootEl:R,name:"sort",toEl:R,fromEl:P,originalEvent:t}),ne({sortable:this,name:"sort",toEl:R,originalEvent:t})),Q&&Q.save()):ce!==ze&&ce>=0&&(ne({sortable:this,name:"update",toEl:R,originalEvent:t}),ne({sortable:this,name:"sort",toEl:R,originalEvent:t})),C.active&&((ce==null||ce===-1)&&(ce=ze,xe=Ze),ne({sortable:this,name:"end",toEl:R,originalEvent:t}),this.save()))),this._nulling()},_nulling:function(){ie("nulling",this),P=m=R=S=Me=K=pt=ke=Oe=fe=Je=ce=xe=ze=Ze=Xe=et=Q=gt=C.dragged=C.ghost=C.clone=C.active=null,Et.forEach(function(t){t.checked=!0}),Et.length=Kt=Rt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":m&&(this._onDragOver(t),fo(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t=[],n,e=this.el.children,r=0,i=e.length,a=this.options;r<i;r++)n=e[r],re(n,a.draggable,this.el,!1)&&t.push(n.getAttribute(a.dataIdAttr)||bo(n));return t},sort:function(t,n){var e={},r=this.el;this.toArray().forEach(function(i,a){var s=r.children[a];re(s,this.options.draggable,r,!1)&&(e[i]=s)},this),n&&this.captureAnimationState(),t.forEach(function(i){e[i]&&(r.removeChild(e[i]),r.appendChild(e[i]))}),n&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,n){return re(t,n||this.options.draggable,this.el,!1)},option:function(t,n){var e=this.options;if(n===void 0)return e[t];var r=qe.modifyOption(this,t,n);typeof r<"u"?e[t]=r:e[t]=n,t==="group"&&yn(e)},destroy:function(){ie("destroy",this);var t=this.el;t[q]=null,k(t,"mousedown",this._onTapStart),k(t,"touchstart",this._onTapStart),k(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(k(t,"dragover",this),k(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),vt.splice(vt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ke){if(ie("hideClone",this),C.eventCanceled)return;E(K,"display","none"),this.options.removeCloneOnHide&&K.parentNode&&K.parentNode.removeChild(K),ke=!0}},_showClone:function(t){if(t.lastPutMode!=="clone"){this._hideClone();return}if(ke){if(ie("showClone",this),C.eventCanceled)return;m.parentNode==P&&!this.options.group.revertClone?P.insertBefore(K,m):Me?P.insertBefore(K,Me):P.appendChild(K),this.options.group.revertClone&&this.animate(m,K),E(K,"display",""),ke=!1}}};function fo(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function St(o,t,n,e,r,i,a,s){var c,d=o[q],h=d.options.onMove,f;return window.CustomEvent&&!Ee&&!We?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=t,c.from=o,c.dragged=n,c.draggedRect=e,c.related=r||t,c.relatedRect=i||B(t),c.willInsertAfter=s,c.originalEvent=a,o.dispatchEvent(c),h&&(f=h.call(d,c,a)),f}function zt(o){o.draggable=!1}function ho(){Lt=!1}function po(o,t,n){var e=B(Fe(n.el,0,n.options,!0)),r=hn(n.el,n.options,S),i=10;return t?o.clientX<r.left-i||o.clientY<e.top&&o.clientX<e.right:o.clientY<r.top-i||o.clientY<e.bottom&&o.clientX<e.left}function go(o,t,n){var e=B(Mt(n.el,n.options.draggable)),r=hn(n.el,n.options,S),i=10;return t?o.clientX>r.right+i||o.clientY>e.bottom&&o.clientX>e.left:o.clientY>r.bottom+i||o.clientX>e.right&&o.clientY>e.top}function mo(o,t,n,e,r,i,a,s){var c=e?o.clientY:o.clientX,d=e?n.height:n.width,h=e?n.top:n.left,f=e?n.bottom:n.right,v=!1;if(!a){if(s&&yt<d*r){if(!tt&&(et===1?c>h+d*i/2:c<f-d*i/2)&&(tt=!0),tt)v=!0;else if(et===1?c<h+yt:c>f-yt)return-et}else if(c>h+d*(1-r)/2&&c<f-d*(1-r)/2)return vo(t)}return v=v||a,v&&(c<h+d*i/2||c>f-d*i/2)?c>h+d/2?1:-1:0}function vo(o){return $(m)<$(o)?1:-1}function bo(o){for(var t=o.tagName+o.className+o.src+o.href+o.textContent,n=t.length,e=0;n--;)e+=t.charCodeAt(n);return e.toString(36)}function yo(o){Et.length=0;for(var t=o.getElementsByTagName("input"),n=t.length;n--;){var e=t[n];e.checked&&Et.push(e)}}function _t(o){return setTimeout(o,0)}function Ht(o){return clearTimeout(o)}wt&&A(document,"touchmove",function(o){(C.active||He)&&o.cancelable&&o.preventDefault()}),C.utils={on:A,off:k,css:E,find:ln,is:function(t,n){return!!re(t,n,t,!1)},extend:to,throttle:dn,closest:re,toggleClass:X,clone:It,index:$,nextTick:_t,cancelNextTick:Ht,detectDirection:bn,getChild:Fe,expando:q},C.get=function(o){return o[q]},C.mount=function(){for(var o=arguments.length,t=new Array(o),n=0;n<o;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(C.utils=ge(ge({},C.utils),e.utils)),qe.mount(e)})},C.create=function(o,t){return new C(o,t)},C.version=Jn;var Y=[],nt,Xt,$t=!1,Yt,Gt,Dt,ot;function Eo(){function o(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this))}return o.prototype={dragStarted:function(n){var e=n.originalEvent;this.sortable.nativeDraggable?A(document,"dragover",this._handleAutoScroll):this.options.supportPointer?A(document,"pointermove",this._handleFallbackAutoScroll):e.touches?A(document,"touchmove",this._handleFallbackAutoScroll):A(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var e=n.originalEvent;!this.options.dragOverBubble&&!e.rootEl&&this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?k(document,"dragover",this._handleAutoScroll):(k(document,"pointermove",this._handleFallbackAutoScroll),k(document,"touchmove",this._handleFallbackAutoScroll),k(document,"mousemove",this._handleFallbackAutoScroll)),Cn(),kt(),no()},nulling:function(){Dt=Xt=nt=$t=ot=Yt=Gt=null,Y.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,e){var r=this,i=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(i,a);if(Dt=n,e||this.options.forceAutoScrollFallback||We||Ee||je){Vt(n,this.options,s,e);var c=De(s,!0);$t&&(!ot||i!==Yt||a!==Gt)&&(ot&&Cn(),ot=setInterval(function(){var d=De(document.elementFromPoint(i,a),!0);d!==c&&(c=d,kt()),Vt(n,r.options,d,e)},10),Yt=i,Gt=a)}else{if(!this.options.bubbleScroll||De(s,!0)===me()){kt();return}Vt(n,this.options,De(s,!1),!1)}}},ue(o,{pluginName:"scroll",initializeByDefault:!0})}function kt(){Y.forEach(function(o){clearInterval(o.pid)}),Y=[]}function Cn(){clearInterval(ot)}var Vt=dn(function(o,t,n,e){if(t.scroll){var r=(o.touches?o.touches[0]:o).clientX,i=(o.touches?o.touches[0]:o).clientY,a=t.scrollSensitivity,s=t.scrollSpeed,c=me(),d=!1,h;Xt!==n&&(Xt=n,kt(),nt=t.scroll,h=t.scrollFn,nt===!0&&(nt=De(n,!0)));var f=0,v=nt;do{var y=v,w=B(y),D=w.top,L=w.bottom,W=w.left,x=w.right,b=w.width,N=w.height,le=void 0,j=void 0,we=y.scrollWidth,Pe=y.scrollHeight,ee=E(y),Ae=y.scrollLeft,se=y.scrollTop;y===c?(le=b<we&&(ee.overflowX==="auto"||ee.overflowX==="scroll"||ee.overflowX==="visible"),j=N<Pe&&(ee.overflowY==="auto"||ee.overflowY==="scroll"||ee.overflowY==="visible")):(le=b<we&&(ee.overflowX==="auto"||ee.overflowX==="scroll"),j=N<Pe&&(ee.overflowY==="auto"||ee.overflowY==="scroll"));var ve=le&&(Math.abs(x-r)<=a&&Ae+b<we)-(Math.abs(W-r)<=a&&!!Ae),te=j&&(Math.abs(L-i)<=a&&se+N<Pe)-(Math.abs(D-i)<=a&&!!se);if(!Y[f])for(var G=0;G<=f;G++)Y[G]||(Y[G]={});(Y[f].vx!=ve||Y[f].vy!=te||Y[f].el!==y)&&(Y[f].el=y,Y[f].vx=ve,Y[f].vy=te,clearInterval(Y[f].pid),(ve!=0||te!=0)&&(d=!0,Y[f].pid=setInterval((function(){e&&this.layer===0&&C.active._onTouchMove(Dt);var Ke=Y[this.layer].vy?Y[this.layer].vy*s:0,pe=Y[this.layer].vx?Y[this.layer].vx*s:0;typeof h=="function"&&h.call(C.dragged.parentNode[q],pe,Ke,o,Dt,Y[this.layer].el)!=="continue"||un(Y[this.layer].el,pe,Ke)}).bind({layer:f}),24))),f++}while(t.bubbleScroll&&v!==c&&(v=De(v,!1)));$t=d}},30),Sn=function(t){var n=t.originalEvent,e=t.putSortable,r=t.dragEl,i=t.activeSortable,a=t.dispatchSortableEvent,s=t.hideGhostForTarget,c=t.unhideGhostForTarget;if(n){var d=e||i;s();var h=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(h.clientX,h.clientY);c(),d&&!d.el.contains(f)&&(a("spill"),this.onSpill({dragEl:r,putSortable:e}))}};function Wt(){}Wt.prototype={startIndex:null,dragStart:function(t){var n=t.oldDraggableIndex;this.startIndex=n},onSpill:function(t){var n=t.dragEl,e=t.putSortable;this.sortable.captureAnimationState(),e&&e.captureAnimationState();var r=Fe(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(n,r):this.sortable.el.appendChild(n),this.sortable.animateAll(),e&&e.animateAll()},drop:Sn},ue(Wt,{pluginName:"revertOnSpill"});function jt(){}jt.prototype={onSpill:function(t){var n=t.dragEl,e=t.putSortable,r=e||this.sortable;r.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),r.animateAll()},drop:Sn},ue(jt,{pluginName:"removeOnSpill"});var _=[],de=[],rt,he,it=!1,ae=!1,$e=!1,I,at,xt;function wo(){function o(t){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));t.options.avoidImplicitDeselect||(t.options.supportPointer?A(document,"pointerup",this._deselectMultiDrag):(A(document,"mouseup",this._deselectMultiDrag),A(document,"touchend",this._deselectMultiDrag))),A(document,"keydown",this._checkKeyDown),A(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(r,i){var a="";_.length&&he===t?_.forEach(function(s,c){a+=(c?", ":"")+s.textContent}):a=i.textContent,r.setData("Text",a)}}}return o.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var e=n.dragEl;I=e},delayEnded:function(){this.isMultiDrag=~_.indexOf(I)},setupClone:function(n){var e=n.sortable,r=n.cancel;if(this.isMultiDrag){for(var i=0;i<_.length;i++)de.push(It(_[i])),de[i].sortableIndex=_[i].sortableIndex,de[i].draggable=!1,de[i].style["will-change"]="",X(de[i],this.options.selectedClass,!1),_[i]===I&&X(de[i],this.options.chosenClass,!1);e._hideClone(),r()}},clone:function(n){var e=n.sortable,r=n.rootEl,i=n.dispatchSortableEvent,a=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||_.length&&he===e&&(_n(!0,r),i("clone"),a()))},showClone:function(n){var e=n.cloneNowShown,r=n.rootEl,i=n.cancel;this.isMultiDrag&&(_n(!1,r),de.forEach(function(a){E(a,"display","")}),e(),xt=!1,i())},hideClone:function(n){var e=this;n.sortable;var r=n.cloneNowHidden,i=n.cancel;this.isMultiDrag&&(de.forEach(function(a){E(a,"display","none"),e.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),r(),xt=!0,i())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&he&&he.multiDrag._deselectMultiDrag(),_.forEach(function(e){e.sortableIndex=$(e)}),_=_.sort(function(e,r){return e.sortableIndex-r.sortableIndex}),$e=!0},dragStarted:function(n){var e=this,r=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(r.captureAnimationState(),this.options.animation)){_.forEach(function(a){a!==I&&E(a,"position","absolute")});var i=B(I,!1,!0,!0);_.forEach(function(a){a!==I&&fn(a,i)}),ae=!0,it=!0}r.animateAll(function(){ae=!1,it=!1,e.options.animation&&_.forEach(function(a){Bt(a)}),e.options.sort&&Tt()})}},dragOver:function(n){var e=n.target,r=n.completed,i=n.cancel;ae&&~_.indexOf(e)&&(r(!1),i())},revert:function(n){var e=n.fromSortable,r=n.rootEl,i=n.sortable,a=n.dragRect;_.length>1&&(_.forEach(function(s){i.addAnimationState({target:s,rect:ae?B(s):a}),Bt(s),s.fromRect=a,e.removeAnimationState(s)}),ae=!1,Co(!this.options.removeCloneOnHide,r))},dragOverCompleted:function(n){var e=n.sortable,r=n.isOwner,i=n.insertion,a=n.activeSortable,s=n.parentEl,c=n.putSortable,d=this.options;if(i){if(r&&a._hideClone(),it=!1,d.animation&&_.length>1&&(ae||!r&&!a.options.sort&&!c)){var h=B(I,!1,!0,!0);_.forEach(function(v){v!==I&&(fn(v,h),s.appendChild(v))}),ae=!0}if(!r)if(ae||Tt(),_.length>1){var f=xt;a._showClone(e),a.options.animation&&!xt&&f&&de.forEach(function(v){a.addAnimationState({target:v,rect:at}),v.fromRect=at,v.thisAnimationDuration=null})}else a._showClone(e)}},dragOverAnimationCapture:function(n){var e=n.dragRect,r=n.isOwner,i=n.activeSortable;if(_.forEach(function(s){s.thisAnimationDuration=null}),i.options.animation&&!r&&i.multiDrag.isMultiDrag){at=ue({},e);var a=Ne(I,!0);at.top-=a.f,at.left-=a.e}},dragOverAnimationComplete:function(){ae&&(ae=!1,Tt())},drop:function(n){var e=n.originalEvent,r=n.rootEl,i=n.parentEl,a=n.sortable,s=n.dispatchSortableEvent,c=n.oldIndex,d=n.putSortable,h=d||this.sortable;if(e){var f=this.options,v=i.children;if(!$e)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),X(I,f.selectedClass,!~_.indexOf(I)),~_.indexOf(I))_.splice(_.indexOf(I),1),rt=null,Qe({sortable:a,rootEl:r,name:"deselect",targetEl:I,originalEvent:e});else{if(_.push(I),Qe({sortable:a,rootEl:r,name:"select",targetEl:I,originalEvent:e}),e.shiftKey&&rt&&a.el.contains(rt)){var y=$(rt),w=$(I);~y&&~w&&y!==w&&function(){var x,b;w>y?(b=y,x=w):(b=w,x=y+1);for(var N=f.filter;b<x;b++)if(!~_.indexOf(v[b])&&re(v[b],f.draggable,i,!1)){var le=N&&(typeof N=="function"?N.call(a,e,v[b],a):N.split(",").some(function(j){return re(v[b],j.trim(),i,!1)}));le||(X(v[b],f.selectedClass,!0),_.push(v[b]),Qe({sortable:a,rootEl:r,name:"select",targetEl:v[b],originalEvent:e}))}}()}else rt=I;he=h}if($e&&this.isMultiDrag){if(ae=!1,(i[q].options.sort||i!==r)&&_.length>1){var D=B(I),L=$(I,":not(."+this.options.selectedClass+")");if(!it&&f.animation&&(I.thisAnimationDuration=null),h.captureAnimationState(),!it&&(f.animation&&(I.fromRect=D,_.forEach(function(x){if(x.thisAnimationDuration=null,x!==I){var b=ae?B(x):D;x.fromRect=b,h.addAnimationState({target:x,rect:b})}})),Tt(),_.forEach(function(x){v[L]?i.insertBefore(x,v[L]):i.appendChild(x),L++}),c===$(I))){var W=!1;_.forEach(function(x){if(x.sortableIndex!==$(x)){W=!0;return}}),W&&(s("update"),s("sort"))}_.forEach(function(x){Bt(x)}),h.animateAll()}he=h}(r===i||d&&d.lastPutMode!=="clone")&&de.forEach(function(x){x.parentNode&&x.parentNode.removeChild(x)})}},nullingGlobal:function(){this.isMultiDrag=$e=!1,de.length=0},destroyGlobal:function(){this._deselectMultiDrag(),k(document,"pointerup",this._deselectMultiDrag),k(document,"mouseup",this._deselectMultiDrag),k(document,"touchend",this._deselectMultiDrag),k(document,"keydown",this._checkKeyDown),k(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof $e<"u"&&$e)&&he===this.sortable&&!(n&&re(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;_.length;){var e=_[0];X(e,this.options.selectedClass,!1),_.shift(),Qe({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvent:n})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},ue(o,{pluginName:"multiDrag",utils:{select:function(n){var e=n.parentNode[q];!e||!e.options.multiDrag||~_.indexOf(n)||(he&&he!==e&&(he.multiDrag._deselectMultiDrag(),he=e),X(n,e.options.selectedClass,!0),_.push(n))},deselect:function(n){var e=n.parentNode[q],r=_.indexOf(n);!e||!e.options.multiDrag||!~r||(X(n,e.options.selectedClass,!1),_.splice(r,1))}},eventProperties:function(){var n=this,e=[],r=[];return _.forEach(function(i){e.push({multiDragElement:i,index:i.sortableIndex});var a;ae&&i!==I?a=-1:ae?a=$(i,":not(."+n.options.selectedClass+")"):a=$(i),r.push({multiDragElement:i,index:a})}),{items:jn(_),clones:[].concat(de),oldIndicies:e,newIndicies:r}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function Co(o,t){_.forEach(function(n,e){var r=t.children[n.sortableIndex+(o?Number(e):0)];r?t.insertBefore(n,r):t.appendChild(n)})}function _n(o,t){de.forEach(function(n,e){var r=t.children[n.sortableIndex+(o?Number(e):0)];r?t.insertBefore(n,r):t.appendChild(n)})}function Tt(){_.forEach(function(o){o!==I&&o.parentNode&&o.parentNode.removeChild(o)})}C.mount(new Eo),C.mount(jt,Wt);const Te="data-key",Be="__mangrove64-fake-row-",Ye="__mangrove64-null-hierarchy-key",So=l.defineComponent({__name:"Mangrove64Tree",props:{nodes:{},columns:{},draggable:{type:Boolean,default:!1},nodeKey:{default:"id"},childrenKey:{default:"children"},parentKey:{default:"parent_id"},hasChildrenKey:{default:"has_children"},disabledKey:{},orderKey:{},expandedNodeAtStart:{},expandeAllNodeAtStart:{type:Boolean,default:!1},selectedNodeAtStart:{},selectionMode:{default:"unique"},resizableColumns:{type:Boolean,default:!1},indentationPx:{default:25},borderStrategy:{default:"none"},tableCssClass:{default:""},rowCssClass:{default:""},cellCssClass:{default:""},nodeKeyType:{default:"number"},checkboxColor:{default:"primary"}},emits:["node-expand","node-collapse","node-select","node-unselect","lazy-load-children","node-move"],setup(o,{expose:t,emit:n}){const e=o,r=n;let i=null;const a=l.useSlots(),s=new Map,c=new Map,d=new Map,h=l.ref([]),f=l.ref(e.columns),v=l.ref(new Set),y=l.ref(new Set),w=l.ref(new Map),D=l.ref(new Set),L=l.ref(new Set),W=l.ref(null),x=l.ref(!1),b=l.ref(!1),N=l.ref(0),le=l.ref("light"),j=Pe(W);function we(){var u,g;c.set(Ye,{parent:Ye+"-unknown",children:[]}),h.value=Ae(e.nodes,0,Ye,[])[0],e.expandeAllNodeAtStart?h.value.forEach(p=>{v.value.add(z(p))}):(u=e.expandedNodeAtStart)==null||u.forEach(p=>{v.value.add(p)}),(g=e.selectedNodeAtStart)==null||g.forEach(p=>{G(p,!0)}),j.start()}function Pe(u){let g;const p={multiDrag:!0,dataIdAttr:"node-key",onStart:()=>{b.value=!0},onEnd:M=>{const O=M.item.getAttribute(Te);if(!O){b.value=!1;return}if(!y.value.has(te(O))){b.value=!1;return}if(O.includes(Be)){b.value=!1;return}if(!i){b.value=!1;return}const F=i.includes(Be)?"brother-to-previous":"child-to-previous",Z=te(i.replaceAll(Be,"")),Se=c.get(Z);if(!Se){b.value=!1;return}let Zt=!1;if([...y.value].sort((V,U)=>(d.get(V)??0)-(d.get(U)??0)).forEach(V=>{const U=c.get(V);if(!U)return;if(y.value.has(U.parent)){const oe=w.value.get(U.parent)??-1;w.value.set(V,oe+1);return}const Ve=c.get(U.parent);Ve&&(Ve.children=Ve.children.filter(oe=>oe!==V));let be=-1;if(F==="brother-to-previous"){U.parent=Se.parent;const oe=c.get(Se.parent);oe&&(be=oe.children.findIndex(Jt=>Jt===Z),be!==-1&&(be+=1),oe.children.splice(be,0,V))}else if(F==="child-to-previous"){U.parent=Z;const oe=c.get(Z);oe&&oe.children.unshift(V)}if(be!==-1&&F==="brother-to-previous"||F==="child-to-previous"){const oe=U.parent===Ye?null:U.parent,Jt=ee(V,0),Fo=d.get(V)??0,ct=h.value.splice(Fo,Jt+1);se();const Lo=d.get(Z)??0;if(oe!==null){const Mn=d.get(oe);if(Mn!==void 0){const On=h.value[Mn];let dt=[];Zt?dt=dt.concat(qt(On)):(dt=[],Zt=!0),dt.push(ct[0]),Dn(On,dt)}}_o(ct[0],oe),Do(ct[0],be),h.value.splice(Lo+1,0,...ct),se(),r("node-move",ct[0],oe,be)}}),F==="child-to-previous"){const V=s.get(Re(Z));if(V&&V.parentElement){const U=V.parentElement;U.removeChild(V),U.insertBefore(V,M.item)}}b.value=!1,i=null,N.value++,l.nextTick(()=>{s.clear(),ve(h.value),j.stop(),j.start(),y.value.forEach(V=>{G(V,!0)})})},onSelect:M=>{const O=M.item.getAttribute(Te);if(!O)return!1;y.value.has(O)||C.utils.deselect(M.item)},onDeselect:M=>{const O=M.item.getAttribute(Te);if(!O)return!1;y.value.has(O)&&C.utils.select(M.item)},onMove:M=>{var V;const O=M.dragged.getAttribute(Te);if(!O||!y.value.has(te(O))||O.includes(Be))return!1;const F=M.willInsertAfter?M.related.getAttribute(Te):(V=M.related.previousElementSibling)==null?void 0:V.getAttribute(Te);if(!F)return!1;i=F;const Z=F.includes(Be)?"brother-to-previous":"child-to-previous",Se=Z==="child-to-previous"&&M.willInsertAfter?te(F):te(F.replaceAll(Be,""));if(!c.get(Se))return!1;[...y.value].sort((U,Ve)=>(d.get(U)??0)-(d.get(Ve)??0)).forEach(U=>{if(!c.get(U))return;const be=w.value.get(Se)??0;Z==="brother-to-previous"?w.value.set(U,be):Z==="child-to-previous"&&w.value.set(U,be+1)})}};return{stop:()=>{e.draggable&&(g==null||g.destroy(),g=void 0)},start:()=>{if(!(!e.draggable||u.value===null)){try{C.mount(new wo)}catch{}g=new C(u.value,{...p})}}}}function ee(u,g){const p=c.get(u);return p&&p.children.forEach(T=>{g++,g=ee(T,g)}),g}function Ae(u,g,p,T){const H=[];return u.sort((M,O)=>Qt(O)-Qt(M)).forEach(M=>{const O=z(M);T.push(M),d.set(O,T.length-1);const F=Ae(qt(M),g+1,O,T);c.set(O,{parent:p,children:F[1]});const Z=c.get(p);Z&&Z.children.push(O),w.value.set(O,g),T=F[0]}),[T,H]}function se(){d.clear(),h.value.forEach((u,g)=>{const p=z(u);d.set(p,g)})}function ve(u){if(!W.value)return;const g=[...W.value.querySelectorAll(".mangrove64-row")];u.forEach(p=>{const T=z(p),H=g.find(O=>{const F=O.getAttribute(Te);return te(F)===T});if(!H)return;s.set(T,H);const M=g.find(O=>{const F=O.getAttribute(Te);return(F==null?void 0:F.toString())===Re(T)});M&&s.set(Re(T),M)})}function te(u){switch(e.nodeKeyType){case"string":return u??"";case"symbol":return Symbol(u==null?void 0:u.toString());case"number":return Number(u)}}function G(u,g){if(g){y.value.add(u);const p=s.get(u),T=s.get(Re(u));p&&T&&e.draggable&&(C.utils.select(p),C.utils.select(T))}else{y.value.delete(u);const p=s.get(u),T=s.get(Re(u));p&&T&&e.draggable&&(C.utils.deselect(p),C.utils.deselect(T))}}function Ke(){y.value.forEach(u=>{const g=s.get(u);g&&C.utils.deselect(g)}),y.value.clear()}function pe(u){var T;let g=()=>{};const p=z(u);switch(e.selectionMode){case"unique":Ke(),G(p,!0),g=()=>r("node-select",u);break;case"multiple":{const H=y.value.has(p);if(H)G(p,!1),g=()=>r("node-unselect",u);else{G(p,!0);const M=(T=c.get(p))==null?void 0:T.parent;M&&G(M,H),g=()=>r("node-select",u)}lt(p,H);break}case"checkbox":return}g()}function Ge(u,g){if(g){if(v.value.add(z(u)),r("node-expand",u),xo(u))return;if(qt(u).length>0){const p=kn(u);if(!p)return;Ce(p,!1,!1)}else{const p=z(u);L.value.add(p),r("lazy-load-children",{node:u,nodeKey:p,done:H=>{const M=d.get(p);if(M===void 0)return;const O=c.get(p);c.set(p,{parent:(O==null?void 0:O.parent)??Ye,children:H.map(Z=>z(Z))});const F=w.value.get(p)??0;H.forEach(Z=>{const Se=z(Z);c.set(Se,{parent:p,children:[]}),w.value.set(Se,F+1)}),Dn(u,H),h.value.splice(M+1,0,...H),se(),l.nextTick(()=>{ve(H),y.value.has(p)&&(G(p,!0),lt(p,!0))})}}),L.value.delete(p)}}else{v.value.delete(z(u)),r("node-collapse",u);const p=kn(u);if(!p)return;Ce(p,!0,!0)}}function Ce(u,g,p){u.children.forEach(T=>{if(g?(D.value.add(T),G(T,!g)):D.value.delete(T),p){const H=c.get(T);H&&Ce(H,g,p)}})}function Ut(u,g){let p=()=>{};const T=z(u);switch(e.selectionMode){case"checkbox":g?(G(T,g),p=()=>r("node-select",u)):(G(T,g),st(T,g),p=()=>r("node-unselect",u)),lt(T,g);break;case"multiple":case"unique":return}p()}function lt(u,g){const p=c.get(u);p&&p.children.forEach(T=>{G(T,g),lt(T,g)})}function st(u,g){const p=c.get(u);p&&(G(p.parent,g),p.parent!==Ye&&st(p.parent,g))}function Re(u){return`${Be}${u.toString()}`}function Dn(u,g){u[e.childrenKey]=g}function _o(u,g){e.parentKey&&(u[e.parentKey]=g)}function Do(u,g){e.orderKey&&(u[e.orderKey]=g)}function ko(u){return u[e.parentKey]}function qt(u){return u[e.childrenKey]??[]}function z(u){return u[e.nodeKey]}function kn(u){const g=z(u);return c.get(g)}function xn(u){const g=z(u);return w.value.get(g)??0}function Qt(u){return u[e.orderKey]??0}function xo(u){return!u[e.hasChildrenKey]}function Tn(u){const g=z(u);return v.value.has(g)}function An(u){const g=z(u);return y.value.has(g)}function To(u){const g=z(u);return L.value.has(g)}function Nn(u){const g=z(u);return D.value.has(g)}function Ao(u){return h.value.find(g=>z(g)===u)}function No(u){const g=d.get(z(u));g!==void 0&&(h.value[g]=u)}function Mo(u){const g=z(u),p=ko(u)??"-1",T=c.get(p);T&&T.children.push(g),c.set(g,{parent:p,children:[]}),w.value.set(g,(w.value.get(p)??0)+1),D.value.has(p)&&D.value.add(g);const H=d.get(p),M=Qt(u);H===void 0?h.value.splice(M,0,u):h.value.splice(H+Math.abs(M),0,u),l.nextTick(()=>{ve([u])}),se()}function Oo(u){const g=c.get(u);!g||g.children.length>0||(h.value=h.value.filter(p=>z(p)!==u),s.delete(u),c.delete(u),v.value.delete(u),y.value.delete(u),w.value.delete(u),D.value.delete(u),se())}function Io(){return y.value}function Bo(){return v.value}function Po(){window.matchMedia("(prefers-color-scheme: dark)").matches&&(le.value="dark")}const Ko=l.computed(()=>{let u="";return u+=e.tableCssClass,u}),Ro=l.computed(()=>{const u=new Map;for(const g in a){const p=a[g];p&&u.set(g,p)}return u});return t({getSelectedKeys:Io,getExpandedKeys:Bo,getNodeByKey:Ao,updateNode:No,addNode:Mo,removeNode:Oo}),l.watch(()=>e.columns,u=>{f.value=u}),l.onMounted(()=>{Po(),we(),l.nextTick(()=>{ve(h.value),x.value=!0})}),l.onScopeDispose(()=>{j.stop()}),(u,g)=>(l.openBlock(),l.createElementBlock("div",null,[l.createElementVNode("div",null,[l.createElementVNode("table",{class:l.normalizeClass(["mangrove64-table",Ko.value])},[l.createElementVNode("thead",null,[l.createElementVNode("tr",null,[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(f.value,(p,T)=>(l.openBlock(),l.createBlock(In,{key:p.name,column:p,resizableColumns:e.resizableColumns,index:T,borderStrategy:e.borderStrategy,theme:le.value},null,8,["column","resizableColumns","index","borderStrategy","theme"]))),128))])]),(l.openBlock(),l.createElementBlock("tbody",{ref_key:"treeBodyEl",ref:W,key:N.value},[(l.openBlock(!0),l.createElementBlock(l.Fragment,null,l.renderList(h.value,p=>(l.openBlock(),l.createElementBlock(l.Fragment,{key:p[e.nodeKey]},[l.createVNode(Hn,{node:p,columns:o.columns,"node-key":e.nodeKey,"children-key":e.childrenKey,"has-children-key":e.hasChildrenKey,"disabled-key":e.disabledKey,selectionMode:e.selectionMode,expanded:Tn(p),selected:An(p),isLoading:To(p),level:xn(p),hidden:Nn(p),indentationPx:e.indentationPx,"row-css-class":e.rowCssClass,"cell-css-class":e.cellCssClass,"border-strategy":e.borderStrategy,"slot-map":Ro.value,"checkbox-color":e.checkboxColor,onNodeExpandToggle:Ge,onNodeCheckboxToggle:Ut,onNodeClick:pe},null,8,["node","columns","node-key","children-key","has-children-key","disabled-key","selectionMode","expanded","selected","isLoading","level","hidden","indentationPx","row-css-class","cell-css-class","border-strategy","slot-map","checkbox-color"]),l.createVNode(Yn,{node:p,columns:o.columns,"node-key":e.nodeKey,"disabled-key":e.disabledKey,expanded:Tn(p),selected:An(p),level:xn(p),hidden:Nn(p),indentationPx:e.indentationPx,"row-css-class":e.rowCssClass,"cell-css-class":e.cellCssClass,"border-strategy":e.borderStrategy,"is-dragging":b.value,onNodeClick:pe},null,8,["node","columns","node-key","disabled-key","expanded","selected","level","hidden","indentationPx","row-css-class","cell-css-class","border-strategy","is-dragging"])],64))),128))]))],2)])]))}});_e.Mangrove64Tree=So,Object.defineProperty(_e,Symbol.toStringTag,{value:"Module"})});
